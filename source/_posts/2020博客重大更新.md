---
title: 2020博客重大更新
comments: true
categories:
  - 七分热爱
tags:
  - 博客
description: 时隔一年，我又折腾起了博客。
abbrlink: d8d5597
date: 2020-12-11 12:05:54
---

## 前言

这两天大概有三十个小时扑在博客上，不禁感慨能把时间花在自己热爱的事情上，是多么幸运的事情。这次把`hexo` 更新到了 `5.2.0` ，`next` 主题也更新到了 `8.1.0` 。升级完还是很值得的，`hexo`现在渲染速度飞快。但期间还是踩了大量的坑，我得从`node.js`开始讲起

## Node&Npm

网上说可以通过安装`node`版本管理工具`n`来升级`node`

```bash
node -v
sudo npm cache chean
sudo npm install n -g
sudo n stable or sudo n x.x.x
```

可惜`windows`不支持`n`, 所以只能去[官网](https://nodejs.org/zh-cn/)下载并覆盖。我干脆删完了`node`重新安装最新版`14.15.1`。

`npm`分为全局安装和本地安装，区别就在于安装的时候是否加了`-g`。我们一般会把一些希望在命令行中直接使用的包，进行全局安装，比如`hexo`、`vue`等。全局安装的包在`win10`中会默认放到`%user%\AppData\Roaming\npm\node_global`，如果你像我一样很讨厌它默认放到C盘，推荐通过以下方法修改默认路径，注意`cache`也最好一起修改。

```bash
npm config set prefix "D:\node\node_global"
npm config set prefix "D:\node\node_cache"
```

更多`node`和`npm`的命令[参考](https://www.runoob.com/nodejs/nodejs-tutorial.html)

## 更新Hexo

我是从[hexo](https://hexo.io/zh-cn/docs/)3点几的版本升级到`5.2`的，虽然跨度很大但是`hexo`的升级并不麻烦。

可以通过`npm-check`,`npm-upgrade`,`npm update`这三个命令来升级

```bash
npm install hexo -g //首先保证全局的hexo最新
hexo version //确认hexo全局最新
npm install -g npm-check
npm install -g npm-upgrade
npm-check //这句在项目内部执行,查看有哪些包可以更新
npm-upgrade //这句在项目内部执行,可以更新的包写入package.json
npm update --save //根据package.json,正式更新项目中的包
```

其实[npm-check](https://www.npmjs.com/package/npm-check)足以完成包管理和升级的工作了，方法千千万，选一种自己喜欢的即可。

{% note info %} 
在查资料的时候发现了一个看起来还不错的包管理工具[npm-check-updates](https://www.npmjs.com/package/npm-check-updates)，它与`npm-check`类似，通过更新`package.json`以及使用`npm install`来更新项目中的包。
{% endnote %}

但因为原先的`Hexo`版本太旧了，站点配置文件`_config.yml`需要做一定的调整。我的做法是去用`hexo init`命令在另一个文件夹中重新生成了一份，然后对比两份站点配置文件`_config.yml`进行修改。具体可以参考这位博主给出的[Hexo-5.x 与 NexT-8.x 跨版本升级](https://www.imczw.com/post/tech/hexo5-next8-updated.html#调整配置)调整配置。更详细的配置文件描述请参考官方文档[配置](https://hexo.io/zh-cn/docs/configuration)



## 升级Next

{% note info %} 
一定要关注[Next的官网](https://theme-next.js.org/docs/)啊！里面有配置文件字段的说明。还有[更新说明及常见问题](https://github.com/next-theme/hexo-theme-next/issues/4)，可以减少很多很多坑。

比如版本的不同对应Next的三个仓库....、**V8.1.0移除了Valine**....

{% endnote %}

`Next`的更新较大，连配置文件的目录都改了，于是我做了旧主题的备份后，删除了旧主题的`themes/next`文件夹，用了新的安装方式`npm install hexo-theme-next`安装后，对照旧主题的配置文件进行修改。注意，将 Next 主题配置文件 `node_modules/hexo-theme-next/_config.yml `改名为 `_config.next.yml` 复制到根目录（与 Hexo 站点配置文件_config.yml 在同一目录），这个文件优先级最高。这样做的好处是以后可以通过 npm 顺滑升级 Next 版本，不用担心配置文件被覆盖。可以参考[ NexT-8.x 跨版本升级](https://www.imczw.com/post/tech/hexo5-next8-updated.html#NexT-8-x%E8%B7%A8%E7%89%88%E6%9C%AC%E5%8D%87%E7%BA%A7)


{% blockquote Next https://github.com/next-theme/hexo-theme-next/issues/4 %}

`NexT `支持在不修改主题仓库内文件的情况下进行配置和自定义，因此无论是使用 `Git `还是` npm `都能顺利更新。如果你见到要求直接修改主题文件的「教程」文章，请谨慎甄别，因为其内容可能过时。

请留意配置方式上的改变，使用 `_config.next.yml` 代替 `source/_data/next.yml`。

{% endblockquote %}

## 博客美化

+ 主题：`Netx.Gemini`

+ 配置: [详见源码](https://github.com/TD21forever/TD21forever.github.io/tree/source)

+ 分类

  + [七分热爱](/categories/三分技术/)
  + [三分技术](/categories/三分技术/)
  + [十分人生](/categories/十分人生/)

+ 样式

  + 参考（😂抄袭）[班班](https://blog.dlzhang.com/)，谢谢博主开源！我实在太喜欢这样的布局和排版。

+ 字体

  参考这篇博客[网站字体优化方案](https://guanqr.com/tech/website/web-font-guide/#)，`Next`[官网](https://theme-next.js.org/docs/theme-settings/miscellaneous.html)关于字体的配置在这里

  + global：EB Garamond,  Noto Serif SC
  + code: JetBrains Mono

+ 插件

  + 评论系统:   ~~Valine 最新版Hexo需自行[安装](https://github.com/next-theme/hexo-next-valine)~~ 已改为更安全的[Waline ](https://waline.js.org/quick-start.html)
  + 字数统计：`hexo-word-counter` 自带
  + 代码高亮：`highlight.js` 可以在这个[网站](https://theme-next.js.org/highlight/)进行预览和挑选
  + 站点分析:  `baidu_analytics`
  + 背景动画:  `canvas_nest` 详见[这里](https://github.com/theme-next/theme-next-canvas-nest)

+ 其他

  + SSL证书与Https：阿里云免费证书

    1. 在阿里云控制台为www.dcts.top添加证书。

    2. 在github page仓库中设置强制开启Https

    3. 在站点配置文件中更改http://www.dcts.top为 https://www.dcts.top

  + 图床：[七牛](https://portal.qiniu.com/create)

    1. 七牛的Https流量是付费的，但是不贵
    2. 如果原先就有仓库以及绑定了非`Https`的域名，不需要新建域名，开启`Https`即可。
    3. 在阿里云控制台为该域名添加证书

  + Tag Plugins: [Next](https://theme-next.js.org/docs/tag-plugins/)以及[Hexo提供的教程](https://hexo.io/docs/tag-plugins)

## 待办事项

+ 书单和观影： 📅 2020/12/20  [参考1](https://michael728.github.io/books/)、[参考2](https://blog.dlzhang.com/posts/51/) ✔
+ Webstack网址导航：  📅 2020/12/25  [参考](https://github.com/WebStackPage/WebStackPage.github.io)
+ 一言 ：📅 2020/12/30 [参考](https://leaferx.online/sentence/)、 [fullpage.js](https://alvarotrigo.com/fullPage/zh/#page2)
+ 说说：📅 2020/12/30 [Artitalk.js](https://cndrew.cn/2020/05/11/artitalk/)  ✔

## 近期更新

+ [博客页面更新介绍](https://www.dcts.top/post/d8d5597/)📅 2020/12/12 ✔

+ 关于博客的一些想法与思考📅 2020/12/28

  > 我写博客的初心是什么，未来怎么运营和坚持？我浏览了很多人的博客，也产生了很多的想法与感慨。

+ 关于博客的写作规范📅 2020/12/28

  > 以及Hexo提供的特殊的写作语法记录

+ 数字货币投资心得📅 2020/12/22

  > 玩数字货币将近三个月了，发现人的理性总是无法战胜人的贪婪。杠杆是把双刃剑，有些东西是底线，决不能触碰，之后会写点自己的心得，警示自己。

+ 2020年末总结📅 2021/01/01

  > 可恶的2020年即将过去，这一年发生了太多太多事了

+ 力扣300题刷题笔记计划 📅 2021/12

+  Flask框架使用笔记📅 2021/01/10 

  > 想通过一个简单的CURD的例子，寻找一套既符合规范又符合自己习惯的后端搭建流程。

+ 耶鲁大学哲学-死亡笔记📅 2021/01/10 

